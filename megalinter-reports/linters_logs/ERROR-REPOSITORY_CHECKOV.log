Results of checkov linter (version 2.4.48)
See documentation on https://megalinter.io/7.4.0/descriptors/repository_checkov/
-----------------------------------------------

‚ùå [ERROR] for workspace /tmp/lint
Linter raw log:
helm scan results:

Passed checks: 72, Failed checks: 16, Skipped checks: 0

Check: CKV_K8S_21: "The default namespace should not be used"
	FAILED for resource: ServiceAccount.default.emissary
	File: /contrib/helm/emissary/templates/serviceaccount.yaml:3-12
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-20.html

		3  | apiVersion: v1
		4  | kind: ServiceAccount
		5  | metadata:
		6  |   name: emissary
		7  |   labels:
		8  |     helm.sh/chart: emissary-0.1.0
		9  |     app.kubernetes.io/name: emissary
		10 |     app.kubernetes.io/instance: release-name
		11 |     app.kubernetes.io/version: "latest"
		12 |     app.kubernetes.io/managed-by: Helm

Check: CKV_K8S_21: "The default namespace should not be used"
	FAILED for resource: Service.default.emissary
	File: /contrib/helm/emissary/templates/service.yaml:3-22
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-20.html

		3  | apiVersion: v1
		4  | kind: Service
		5  | metadata:
		6  |   name: emissary
		7  |   labels:
		8  |     helm.sh/chart: emissary-0.1.0
		9  |     app.kubernetes.io/name: emissary
		10 |     app.kubernetes.io/instance: release-name
		11 |     app.kubernetes.io/version: "latest"
		12 |     app.kubernetes.io/managed-by: Helm
		13 | spec:
		14 |   type: ClusterIP
		15 |   ports:
		16 |     - port: 8001
		17 |       targetPort: http
		18 |       protocol: TCP
		19 |       name: http
		20 |   selector:
		21 |     app.kubernetes.io/name: emissary
		22 |     app.kubernetes.io/instance: release-name

Check: CKV_K8S_20: "Containers should not run with allowPrivilegeEscalation"
	FAILED for resource: Deployment.default.emissary
	File: /contrib/helm/emissary/templates/deployment.yaml:3-54
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-19.html

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_K8S_43: "Image should use digest"
	FAILED for resource: Deployment.default.emissary
	File: /contrib/helm/emissary/templates/deployment.yaml:3-54
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-39.html

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_K8S_23: "Minimize the admission of root containers"
	FAILED for resource: Deployment.default.emissary
	File: /contrib/helm/emissary/templates/deployment.yaml:3-54
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-22.html

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_K8S_28: "Minimize the admission of containers with the NET_RAW capability"
	FAILED for resource: Deployment.default.emissary
	File: /contrib/helm/emissary/templates/deployment.yaml:3-54
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-27.html

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_K8S_14: "Image Tag should be fixed - not latest or blank"
	FAILED for resource: Deployment.default.emissary
	File: /contrib/helm/emissary/templates/deployment.yaml:3-54
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-13.html

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_K8S_40: "Containers should run as a high UID to avoid host conflict"
	FAILED for resource: Deployment.default.emissary
	File: /contrib/helm/emissary/templates/deployment.yaml:3-54
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-37.html

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_K8S_22: "Use read-only filesystem for containers where possible"
	FAILED for resource: Deployment.default.emissary
	File: /contrib/helm/emissary/templates/deployment.yaml:3-54
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-21.html

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_K8S_31: "Ensure that the seccomp profile is set to docker/default or runtime/default"
	FAILED for resource: Deployment.default.emissary
	File: /contrib/helm/emissary/templates/deployment.yaml:3-54
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-29.html

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_K8S_13: "Memory limits should be set"
	FAILED for resource: Deployment.default.emissary
	File: /contrib/helm/emissary/templates/deployment.yaml:3-54
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-12.html

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_K8S_11: "CPU limits should be set"
	FAILED for resource: Deployment.default.emissary
	File: /contrib/helm/emissary/templates/deployment.yaml:3-54
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-10.html

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_K8S_37: "Minimize the admission of containers with capabilities assigned"
	FAILED for resource: Deployment.default.emissary
	File: /contrib/helm/emissary/templates/deployment.yaml:3-54
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-34.html

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_K8S_21: "The default namespace should not be used"
	FAILED for resource: Deployment.default.emissary
	File: /contrib/helm/emissary/templates/deployment.yaml:3-54
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-20.html

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_K8S_15: "Image Pull Policy should be Always"
	FAILED for resource: Deployment.default.emissary
	File: /contrib/helm/emissary/templates/deployment.yaml:3-54
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-14.html

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_K8S_38: "Ensure that Service Account Tokens are only mounted where necessary"
	FAILED for resource: Deployment.default.emissary
	File: /contrib/helm/emissary/templates/deployment.yaml:3-54
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-35.html

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
dockerfile scan results:

Passed checks: 235, Failed checks: 4, Skipped checks: 0

Check: CKV_DOCKER_4: "Ensure that COPY is used instead of ADD in Dockerfiles"
	FAILED for resource: /contrib/docker/Dockerfile.alpine.ADD
	File: /contrib/docker/Dockerfile.alpine:12-12
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/docker-policies/docker-policy-index/ensure-that-copy-is-used-instead-of-add-in-dockerfiles.html

		12 | ADD target/emissary-*-dist.tar.gz /opt

Check: CKV_DOCKER_3: "Ensure that a user for the container has been created"
	FAILED for resource: /contrib/docker/Dockerfile.alpine.
	File: /contrib/docker/Dockerfile.alpine:1-31
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/docker-policies/docker-policy-index/ensure-that-a-user-for-the-container-has-been-created.html

		1  | FROM alpine:3.16.3
		2  | 
		3  | RUN  apk update \
		4  |   && apk upgrade \
		5  |   && apk add ca-certificates \
		6  |   && update-ca-certificates \
		7  |   && apk add --update coreutils && rm -rf /var/cache/apk/*   \ 
		8  |   && apk add --update openjdk11 tzdata curl unzip bash \
		9  |   && apk add --no-cache nss \
		10 |   && rm -rf /var/cache/apk/*
		11 | 
		12 | ADD target/emissary-*-dist.tar.gz /opt
		13 | 
		14 | RUN ls -al /opt && \
		15 |     version=`ls /opt | grep emissary- | awk '{ print $1 }'` && \
		16 |     echo "Linking /opt/${version} to /opt/emissary" && \
		17 |     ln -s /opt/${version} /opt/emissary && \
		18 |     mkdir -p /opt/emissary/localoutput && \
		19 |     chmod -R a+rw /opt/emissary
		20 | 
		21 | ENV PROJECT_BASE=/opt/emissary
		22 | 
		23 | WORKDIR /opt/emissary
		24 | 
		25 | VOLUME /opt/emissary/localoutput
		26 | 
		27 | EXPOSE 8000 8001
		28 | 
		29 | ENTRYPOINT ["./emissary"]
		30 | 
		31 | CMD ["server", "-a", "2", "-p", "8001"]
Check: CKV_DOCKER_4: "Ensure that COPY is used instead of ADD in Dockerfiles"
	FAILED for resource: /contrib/docker/Dockerfile.ADD
	File: /contrib/docker/Dockerfile:10-10
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/docker-policies/docker-policy-index/ensure-that-copy-is-used-instead-of-add-in-dockerfiles.html

		10 | ADD target/emissary-*-dist.tar.gz /opt

Check: CKV_DOCKER_3: "Ensure that a user for the container has been created"
	FAILED for resource: /contrib/docker/Dockerfile.
	File: /contrib/docker/Dockerfile:1-29
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/docker-policies/docker-policy-index/ensure-that-a-user-for-the-container-has-been-created.html

		1  | FROM centos:7
		2  | 
		3  | RUN yum update -y \
		4  |     && rpm --import https://yum.corretto.aws/corretto.key \
		5  |     && curl -L -o /etc/yum.repos.d/corretto.repo https://yum.corretto.aws/corretto.repo \
		6  |     && yum install -y java-11-amazon-corretto-devel \
		7  |     && yum clean all -y \
		8  |     && rm -rf /var/cache/yum
		9  | 
		10 | ADD target/emissary-*-dist.tar.gz /opt
		11 | 
		12 | RUN ls -al /opt && \
		13 |     version=`ls /opt | grep emissary- | awk '{ print $1 }'` && \
		14 |     echo "Linking /opt/${version} to /opt/emissary" && \
		15 |     ln -s /opt/${version} /opt/emissary && \
		16 |     mkdir -p /opt/emissary/localoutput && \
		17 |     chmod -R a+rw /opt/emissary
		18 | 
		19 | ENV PROJECT_BASE=/opt/emissary
		20 | 
		21 | WORKDIR /opt/emissary
		22 | 
		23 | VOLUME /opt/emissary/localoutput
		24 | 
		25 | EXPOSE 8000 8001
		26 | 
		27 | ENTRYPOINT ["./emissary"]
		28 | 
		29 | CMD ["server", "-a", "2", "-p", "8001"]

github_actions scan results:

Passed checks: 340, Failed checks: 11, Skipped checks: 0

Check: CKV_GHA_7: "The build output cannot be affected by user parameters other than the build entry point and the top-level source location. GitHub Actions workflow_dispatch inputs MUST be empty. "
	FAILED for resource: on(Cherry pick commit(s) to a branch)
	File: /.github/workflows/cherrypick.yml:7-12

		7  |       cherrypick_commits:
		8  |         description: "List of space delimited commits to cherry pick"
		9  |         required: false
		10 |         default: ""
		11 |   workflow_call:
		12 |     inputs:

Check: CKV_GHA_7: "The build output cannot be affected by user parameters other than the build entry point and the top-level source location. GitHub Actions workflow_dispatch inputs MUST be empty. "
	FAILED for resource: on(Create a Patch Branch)
	File: /.github/workflows/create-patch-branch.yml:7-13

		7  |       cherrypick_commits:
		8  |         description: "List of space delimited commits to cherry pick"
		9  |         required: false
		10 |         default: ""
		11 | 
		12 | env:
		13 |   JAVA_VERSION: "11"

Check: CKV_GHA_7: "The build output cannot be affected by user parameters other than the build entry point and the top-level source location. GitHub Actions workflow_dispatch inputs MUST be empty. "
	FAILED for resource: on(Maven: Release)
	File: /.github/workflows/maven-release.yml:9-24

		9  |       release_type:
		10 |         description: "Choose the release type"
		11 |         required: true
		12 |         default: "release"
		13 |         type: choice
		14 |         options:
		15 |           - release
		16 |           - milestone
		17 |           - patch
		18 |       release_suffix:
		19 |         description: "Add a suffix to the release version (-M1)"
		20 |         required: false
		21 |         default: ""
		22 | 
		23 | env:
		24 |   JAVA_VERSION: "11"

Check: CKV_GHA_7: "The build output cannot be affected by user parameters other than the build entry point and the top-level source location. GitHub Actions workflow_dispatch inputs MUST be empty. "
	FAILED for resource: on(Maven: Set Next Development Version)
	File: /.github/workflows/maven-version.yml:8-14

		8  |       next_version:
		9  |         description: "Set the next development version"
		10 |         required: true
		11 |         default: ""
		12 | 
		13 | env:
		14 |   JAVA_VERSION: "11"

Check: CKV2_GHA_1: "Ensure top-level permissions are not set to write-all"
	FAILED for resource: on(Cherry pick commit(s) to a branch)
	File: /.github/workflows/cherrypick.yml:23-24
Check: CKV2_GHA_1: "Ensure top-level permissions are not set to write-all"
	FAILED for resource: on(CodeQL)
	File: /.github/workflows/codeql-analysis.yml:28-29
Check: CKV2_GHA_1: "Ensure top-level permissions are not set to write-all"
	FAILED for resource: on(Create a Patch Branch)
	File: /.github/workflows/create-patch-branch.yml:29-30
Check: CKV2_GHA_1: "Ensure top-level permissions are not set to write-all"
	FAILED for resource: on(Java CI with Maven)
	File: /.github/workflows/maven-ci.yml:0-1
Check: CKV2_GHA_1: "Ensure top-level permissions are not set to write-all"
	FAILED for resource: on(Maven: Publish Packages to GitHub)
	File: /.github/workflows/maven-publish.yml:19-20
Check: CKV2_GHA_1: "Ensure top-level permissions are not set to write-all"
	FAILED for resource: on(Maven: Release)
	File: /.github/workflows/maven-release.yml:61-62
Check: CKV2_GHA_1: "Ensure top-level permissions are not set to write-all"
	FAILED for resource: on(Maven: Set Next Development Version)
	File: /.github/workflows/maven-version.yml:30-31


